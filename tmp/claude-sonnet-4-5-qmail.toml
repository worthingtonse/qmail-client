# QMail Client Core Configuration
# Generated by: Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)
# Date: 2025-12-11
# Format: TOML v1.0.0
#
# This configuration file contains all settings for the QMail Client Core.
# Settings are organized by functional area and marked by implementation phase.
#
# Legend:
#   [Phase I]  - Implement immediately
#   [Phase II] - Future implementation
#   [Required] - Must be configured
#   [Optional] - Has sensible default
#
# For C conversion: All keys use snake_case. Units are explicit in key names.

# ============================================================================
# METADATA
# ============================================================================
[metadata]
config_version = "1.0.0"
implementation_phase = "I"
last_modified = "2025-12-11"

# ============================================================================
# SYSTEM CONFIGURATION [Phase I]
# ============================================================================
[system]
# Application name and version
app_name = "QMail Client Core"
app_version = "0.1.0"

# Working directory for relative paths (optional, defaults to executable location)
# working_directory = "/path/to/qmail"

# ============================================================================
# LOGGING CONFIGURATION [Phase I]
# ============================================================================
[logging]
# Path to the mail.mlog file (supports relative and absolute paths)
# [Required]
log_path = "Data/mail.mlog"

# Logging verbosity: "DEBUG", "INFO", "WARNING", "ERROR"
# [Optional] Default: "INFO"
log_level = "INFO"

# Buffer size in bytes before flushing to disk (performance optimization)
# [Optional] Default: 4096
log_buffer_size_bytes = 4096

# Enable timestamps in log entries
# [Optional] Default: true
log_timestamps = true

# Enable thread IDs in log entries (useful for debugging concurrency)
# [Optional] Default: false
log_thread_ids = false

# Maximum log file size in MB before rotation
# [Optional] Default: 100
log_max_size_mb = 100

# Number of rotated log files to keep
# [Optional] Default: 5
log_rotation_count = 5

# ============================================================================
# DATABASE CONFIGURATION [Phase I]
# ============================================================================
[database]
# Path to SQLite database file
# [Required]
db_path = "Data/qmail.db"

# Enable SQLite Write-Ahead Logging for better concurrency
# [Optional] Default: true
wal_mode = true

# SQLite cache size in KB
# [Optional] Default: 2000 (2MB)
cache_size_kb = 2000

# Enable foreign key constraints
# [Optional] Default: true
foreign_keys = true

# Auto-vacuum mode: "NONE", "FULL", "INCREMENTAL"
# [Optional] Default: "INCREMENTAL"
auto_vacuum = "INCREMENTAL"

# Database busy timeout in milliseconds
# [Optional] Default: 5000
busy_timeout_ms = 5000

# ============================================================================
# NETWORK CONFIGURATION [Phase I]
# ============================================================================
[network]
# TCP connection timeout in milliseconds
# [Optional] Default: 5000
connection_timeout_ms = 5000

# Read timeout for socket operations in milliseconds
# [Optional] Default: 10000
read_timeout_ms = 10000

# Write timeout for socket operations in milliseconds
# [Optional] Default: 10000
write_timeout_ms = 10000

# Maximum retry attempts for failed network operations
# [Optional] Default: 3
max_retry_attempts = 3

# Delay between retries in milliseconds (exponential backoff)
# [Optional] Default: 1000
retry_delay_ms = 1000

# Enable TCP keepalive
# [Optional] Default: true
tcp_keepalive = true

# ============================================================================
# BEACON CONFIGURATION [Phase I]
# ============================================================================
[network.beacon]
# Beacon server TCP address and port
# [Required] Default: RAIDA server #14
beacon_url = "tcp://168.220.219.199:50014"

# Interval between beacon checks in seconds (10 minutes default)
# [Optional] Default: 600
beacon_interval_sec = 600

# RAIDA index used as beacon server (0-24, typically 14)
# [Required]
raida_beacon_index = 14

# Beacon request timeout in milliseconds
# [Optional] Default: 30000 (30 seconds)
beacon_timeout_ms = 30000

# ============================================================================
# RAIDA GUARDIAN SERVERS [Phase I]
# ============================================================================
# Complete list of 25 RAIDA servers (Guardians)
# These can be used for various RAIDA operations beyond just QMail storage
# The beacon server (index 14) is part of this list

[[network.raida_servers]]
id = 0
address = "78.46.170.45"
port = 50000

[[network.raida_servers]]
id = 1
address = "47.229.9.94"
port = 50001

[[network.raida_servers]]
id = 2
address = "209.46.126.167"
port = 50002

[[network.raida_servers]]
id = 3
address = "116.203.157.233"
port = 50003

[[network.raida_servers]]
id = 4
address = "95.183.51.104"
port = 50004

[[network.raida_servers]]
id = 5
address = "31.163.201.90"
port = 50005

[[network.raida_servers]]
id = 6
address = "52.14.83.91"
port = 50006

[[network.raida_servers]]
id = 7
address = "161.97.169.229"
port = 50007

[[network.raida_servers]]
id = 8
address = "13.234.55.11"
port = 50008

[[network.raida_servers]]
id = 9
address = "124.187.106.233"
port = 50009

[[network.raida_servers]]
id = 10
address = "94.130.179.247"
port = 50010

[[network.raida_servers]]
id = 11
address = "67.181.90.11"
port = 50011

[[network.raida_servers]]
id = 12
address = "3.16.169.178"
port = 50012

[[network.raida_servers]]
id = 13
address = "113.30.247.109"
port = 50013

[[network.raida_servers]]
id = 14
address = "168.220.219.199"
port = 50014

[[network.raida_servers]]
id = 15
address = "185.37.61.73"
port = 50015

[[network.raida_servers]]
id = 16
address = "193.7.195.250"
port = 50016

[[network.raida_servers]]
id = 17
address = "5.161.63.179"
port = 50017

[[network.raida_servers]]
id = 18
address = "76.114.47.144"
port = 50018

[[network.raida_servers]]
id = 19
address = "190.105.235.113"
port = 50019

[[network.raida_servers]]
id = 20
address = "184.18.166.118"
port = 50020

[[network.raida_servers]]
id = 21
address = "125.236.210.184"
port = 50021

[[network.raida_servers]]
id = 22
address = "5.161.123.254"
port = 50022

[[network.raida_servers]]
id = 23
address = "130.255.77.156"
port = 50023

[[network.raida_servers]]
id = 24
address = "209.205.66.24"
port = 50024

# ============================================================================
# QMAIL STORAGE SERVER LIST [Phase I]
# ============================================================================
# Array of QMail storage servers for stripe distribution
# Phase I uses 5 specific RAIDA servers for email stripe storage
# 4 data stripes + 1 parity stripe = 5 servers required
# [Required] These are the designated QMail servers for Phase I

[[network.qmail_servers]]
address = "47.229.9.94"
port = 50001
server_type = "QMAIL"
description = "QMail Storage Server 1"

[[network.qmail_servers]]
address = "124.187.106.233"
port = 50009
server_type = "QMAIL"
description = "QMail Storage Server 2"

[[network.qmail_servers]]
address = "113.30.247.109"
port = 50013
server_type = "QMAIL"
description = "QMail Storage Server 3"

[[network.qmail_servers]]
address = "168.220.219.199"
port = 50014
server_type = "QMAIL"
description = "QMail Storage Server 4 (also Beacon)"

[[network.qmail_servers]]
address = "125.236.210.184"
port = 50021
server_type = "QMAIL"
description = "QMail Storage Server 5"

# ============================================================================
# DATA STRIPING & PARITY CONFIGURATION [Phase I]
# ============================================================================
[striping]
# Number of data stripes (RAID-style distribution)
# [Required] Default: 4
data_stripe_count = 4

# Number of parity stripes for redundancy/recovery
# [Required] Default: 1
parity_stripe_count = 1

# Size of each stripe in bytes
# [Variable] Stripe size is calculated dynamically based on document size
# Formula: stripe_size = document_size * 0.25 (approximately)
# Each of the 4 data stripes gets ~25% of the document
# The parity stripe is also ~25% of the total document size
# NOTE: This is NOT a configuration parameter - calculated at runtime
# stripe_size_bytes = <calculated dynamically>

# RAID type: Currently using RAID-5 style with parity
# [Phase I] Default: "RAID5"
raid_type = "RAID5"

# Minimum number of stripes required to reconstruct data
# [Optional] Calculated as: data_stripe_count
# With 4 data stripes + 1 parity, we can lose 1 stripe and still recover
min_stripes_for_recovery = 4

# ============================================================================
# ENCRYPTION CONFIGURATION [Phase I]
# ============================================================================
[encryption]
# Master switch to enable/disable encryption
# [Required] Default: true
enabled = true

# Encryption mode: "A" (session-based) or "B" (AN-based)
# [Phase I] Default: "A"
# Mode A: Uses Session ID (16 bytes) - more secure
# Mode B: Uses Authenticity Number - compatibility mode
mode = "A"

# AES key size in bits (128 per specification)
# [Required] Default: 128
aes_key_size_bits = 128

# Cipher mode: "CBC", "CTR", "GCM"
# [Optional] Default: "CBC"
cipher_mode = "CBC"

# Enable secure key derivation from passwords (PBKDF2)
# [Optional] Default: true
enable_key_derivation = true

# PBKDF2 iteration count for key derivation
# [Optional] Default: 100000
pbkdf2_iterations = 100000

# ============================================================================
# THREADING & CONCURRENCY [Phase I]
# ============================================================================
[threading]
# Number of worker threads in the thread pool
# [Required] Minimum: 5 (one per QMail server for parallel stripe operations)
# Recommended: 5-10 depending on workload
# Set to 0 for auto-detection based on CPU cores (minimum 5)
thread_pool_size = 5

# Maximum concurrent stripe upload operations
# [Optional] Default: 10
# Should be >= number of QMail servers (5) for parallel uploads
max_concurrent_uploads = 10

# Maximum concurrent stripe download operations
# [Optional] Default: 10
# Should be >= number of QMail servers (5) for parallel downloads
max_concurrent_downloads = 10

# Task queue size (0 = unlimited)
# [Optional] Default: 100
task_queue_size = 100

# Thread stack size in KB
# [Optional] Default: 0 (system default)
thread_stack_size_kb = 0

# ============================================================================
# REST API SERVER CONFIGURATION [Phase I]
# ============================================================================
[api]
# API server bind address (127.0.0.1 for localhost only, 0.0.0.0 for all interfaces)
# [Required] Default: "127.0.0.1"
host = "127.0.0.1"

# API server port
# [Required] Must be specified at startup via command-line argument
# Example: python main.py --port 8080
# This allows flexible port assignment without config file changes
# Valid range: 1024-65535 (ports below 1024 require admin privileges)
port = 8080

# Enable CORS for web-based GUI clients
# [Optional] Default: false
enable_cors = false

# Allowed CORS origins (if enable_cors = true)
# [Optional] Example: ["http://localhost:3000", "https://qmail-gui.example.com"]
cors_allowed_origins = []

# Maximum request body size in MB
# [Optional] Default: 100
max_request_size_mb = 100

# Request timeout in seconds
# [Optional] Default: 300 (5 minutes)
request_timeout_sec = 300

# Enable API authentication (Phase II feature)
# [Phase II] Default: false
enable_authentication = false

# API key for authentication (if enabled)
# [Phase II]
# api_key = "your-secret-api-key-here"

# ============================================================================
# USER IDENTITY CONFIGURATION [Phase I]
# ============================================================================
[identity]
# CloudCoin type identifier (fixed at 0x0006 per QMail specification)
# [Required] Default: 6
coin_type = 6

# User's denomination (1-250)
# [Required] MUST BE CONFIGURED BY USER
# This value is obtained from the user's CloudCoin wallet
# Available wallets are located at: build/Data/Wallets/
# Example: 1 for 1-note denomination
denomination = 1

# User's serial number (mailbox ID) - 4 bytes stored as integer
# [Required] MUST BE CONFIGURED BY USER
# This is the user's unique mailbox identifier from their CloudCoin
# Available wallets are located at: build/Data/Wallets/
# Example: 161 = 0x000000A1
serial_number = 161

# Device ID - 16-bit identifier for this device/installation
# [Optional] Default: 1
# Range: 0-65535
device_id = 1

# Authenticity Number (16 bytes as hex string) - for Mode B encryption
# [Required for Mode B] Leave empty for Mode A
# Format: 32 hex characters
# authenticity_number = "00000000000000000000000000000000"

# User profile information (Phase I - basic, Phase II - extended)
[identity.profile]
first_name = ""
middle_name = ""
last_name = ""
# avatar_guid = ""  # 16-byte GUID as hex string (Phase II)

# ============================================================================
# CLOUDCOIN & PAYMENT CONFIGURATION [Phase I]
# ============================================================================
[cloudcoin]
# Directory where locker files are stored
# [Required]
locker_storage_path = "Data/Lockers"

# Default storage duration for uploads
# [Optional] Duration codes per upload specification
# 0 = Permanent, 1 = 1 day, 2 = 1 week, 3 = 1 month, etc.
default_storage_duration = 3

# Automatically withdraw coins from locker for payments
# [Optional] Default: true
auto_withdraw_enabled = true

# Minimum balance warning threshold (in coin count)
# [Optional] Default: 10
min_balance_warning = 10

# Validate coins before use
# [Optional] Default: true
validate_coins_before_use = true

# Locker backup directory
# [Phase II]
# locker_backup_path = "Data/Lockers/Backup"

# ============================================================================
# EMAIL PROCESSING CONFIGURATION [Phase I]
# ============================================================================
[email]
# Maximum size for a single attachment in MB
# [Optional] Default: 25
max_attachment_size_mb = 25

# Maximum total email size in MB (including all attachments)
# [Optional] Default: 100
max_email_size_mb = 100

# Maximum subject length in characters
# [Optional] Default: 255
max_subject_length = 255

# CBDF compression level (0-9, where 0=none, 9=maximum)
# [Optional] Default: 6
cbdf_compression_level = 6

# Attachment storage mode: "INTERNAL" (in database) or "EXTERNAL" (file system)
# [Optional] Default: "INTERNAL"
# For attachments > attachment_external_threshold_mb, use EXTERNAL regardless
attachment_storage_mode = "INTERNAL"

# Threshold in MB above which attachments are always stored externally
# [Optional] Default: 10
attachment_external_threshold_mb = 10

# External attachment storage directory (if using EXTERNAL mode)
# [Optional] Default: "Data/Attachments"
attachment_storage_path = "Data/Attachments"

# ============================================================================
# SEARCH ENGINE CONFIGURATION [Phase I]
# ============================================================================
[search]
# Enable SQLite FTS5 full-text search extension
# [Optional] Default: true
enable_fts5 = true

# Maximum number of search results to return
# [Optional] Default: 100
max_results = 100

# Search result ranking algorithm: "BM25", "SIMPLE"
# [Optional] Default: "BM25"
ranking_algorithm = "BM25"

# Automatically update search index on email insert/update
# [Optional] Default: true
auto_index = true

# Search index update interval in seconds (if auto_index = false)
# [Phase II] Default: 60
# index_update_interval_sec = 60

# ============================================================================
# TASK MANAGER CONFIGURATION [Phase I]
# ============================================================================
[tasks]
# Maximum number of concurrent tasks
# [Optional] Default: 50
max_concurrent_tasks = 50

# Task status update interval in milliseconds
# [Optional] Default: 500
status_update_interval_ms = 500

# Completed task retention time in seconds
# [Optional] Default: 3600 (1 hour)
completed_task_retention_sec = 3600

# Failed task retention time in seconds
# [Optional] Default: 86400 (24 hours)
failed_task_retention_sec = 86400

# ============================================================================
# PHASE II FEATURES (Future Implementation)
# ============================================================================

# [Phase II] AI-based features
[ai]
enabled = false
# semantic_encoding_enabled = false
# image_processing_enabled = false
# avatar_generation_enabled = false
# avatar_storage_path = "Data/Avatars"

# [Phase II] Advanced networking
[network.advanced]
# bandwidth_limit_kbps = 0  # 0 = unlimited
# prefer_ipv6 = false
# proxy_enabled = false
# proxy_address = ""
# proxy_port = 0

# [Phase II] Content formatting
[formatting]
# enable_subject_formatting = true
# enable_rich_text = true
# signature_storage_path = "Data/Signatures"

# [Phase II] Advanced CloudCoin
[cloudcoin.advanced]
# validation_strictness = "STANDARD"  # STRICT, STANDARD, LENIENT
# payment_retry_attempts = 3
# enable_automatic_pown = false

# ============================================================================
# DEVELOPER & DEBUG OPTIONS
# ============================================================================
[developer]
# Enable debug mode (verbose logging, additional checks)
# [Optional] Default: false
debug_mode = false

# Enable performance profiling
# [Optional] Default: false
enable_profiling = false

# Mock network operations (for testing without servers)
# [Optional] Default: false
mock_network = false

# Simulate slow network (artificial delay in ms)
# [Optional] Default: 0
simulate_network_delay_ms = 0

# ============================================================================
# END OF CONFIGURATION
# ============================================================================
